<mat-card class="panel" data-testid="roots-card">
  <mat-card-title class="panel-title panel-title--roots">Roots</mat-card-title>
  <mat-card-content>
    <div class="root-list">
      <div *ngFor="let root of roots()" class="root-item">
        <div class="root-row">
          <mat-checkbox
            class="root-select"
            [checked]="isSelected(root.id)"
            (change)="toggleSelected(root.id, $event.checked)"
            [matTooltip]="'Include this root in the Rescan selected roots action.'"
            [attr.data-testid]="'scan-root-select-' + root.id"
            [attr.aria-label]="'Select root ' + root.path + ' for rescan'"
          ></mat-checkbox>

          <div class="root-main">
            <span class="path" data-testid="scan-root-path">{{ root.path }}</span>
            <span class="summary" data-testid="root-last-summary" *ngIf="root.lastScanState; else noScanSummary">
              Last: {{ root.lastScanState }} · {{ root.lastScanFiles ?? 0 | number }} files ·
              {{ root.lastScanAt | date: 'yyyy-MM-dd HH:mm' }}
            </span>
            <ng-template #noScanSummary>
              <span class="summary summary--empty">No scans yet</span>
            </ng-template>
            <mat-form-field
              appearance="outline"
              class="depth-field"
              *ngIf="isSelected(root.id)"
              [attr.data-testid]="'scan-root-depth-field-' + root.id"
            >
              <mat-label>Depth limit</mat-label>
              <input
                matInput
                type="number"
                min="1"
                step="1"
                [value]="getDepthInputValue(root.id)"
                (input)="onDepthInput(root.id, $any($event.target).value)"
                [attr.data-testid]="'scan-root-depth-input-' + root.id"
              />
            </mat-form-field>
          </div>

          <div class="root-meta">
            <div class="badges">
              <span class="badge badge--projects" data-testid="root-project-count">
                Projects {{ root.projectCount ?? 0 }}
              </span>
              <span class="badge badge--pending" data-testid="root-pending-count">
                Pending {{ root.ongoingSuggestionCount ?? 0 }}
              </span>
            </div>
            <span class="status" [attr.data-status]="root.status">{{ root.status }}</span>
          </div>
        </div>
      </div>
    </div>
  </mat-card-content>
</mat-card>
