<mat-card class="panel" data-testid="status-card">
  <mat-card-title class="panel-title panel-title--status">Active scans</mat-card-title>
  <mat-card-content class="status-content">
    <div class="empty" *ngIf="(scans$ | async)?.length === 0">
      No active scans yet.
    </div>
    <div class="scan-item" *ngFor="let scan of scans$ | async" [attr.data-state]="scan.state">
      <div class="scan-header">
        <div class="scan-title">
          <strong>{{ scan.rootPath }}</strong>
          <span class="scan-meta">{{ scan.mode }} Â· {{ scan.disk }}</span>
        </div>
        <span class="scan-state" [attr.data-state]="scan.state">{{ scan.state }}</span>
      </div>

      <div class="scan-row" *ngIf="scan.state === 'Queued'">
        <span>Queue</span>
        <strong>{{ scan.queueReason }}</strong>
      </div>

      <div class="scan-row" *ngIf="scan.state !== 'Queued'">
        <span>Current</span>
        <strong>{{ scan.currentPath }}</strong>
      </div>
      <div class="scan-row">
        <span>ETA</span>
        <strong>{{ scan.eta ?? '--' }}</strong>
      </div>
      <div class="scan-row">
        <span>Files scanned</span>
        <strong>{{ scan.filesScanned | number }}</strong>
      </div>
      <mat-progress-bar
        [mode]="isIndeterminate(scan) ? 'indeterminate' : 'determinate'"
        [value]="scan.progress"
      ></mat-progress-bar>
      <div class="scan-actions">
        <button mat-stroked-button *ngIf="scan.state === 'Running'" (click)="pause(scan)">
          Pause
        </button>
        <button mat-stroked-button *ngIf="scan.state === 'Paused'" (click)="resume(scan)">
          Resume
        </button>
        <button
          mat-stroked-button
          color="warn"
          *ngIf="canStop(scan)"
          [attr.data-testid]="'scan-stop-btn-' + scan.id"
          (click)="stop(scan)"
        >
          Stop
        </button>
      </div>
    </div>
  </mat-card-content>
</mat-card>
